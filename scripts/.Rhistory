scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
#Tibia model
tibia_Condition_f <- glmmTMB(tibia ~ (sex + treatment + cohort_factor)^3
+ diag(1 + thorax_c + cohort_factor| treatment:replicate),
data = wide_fly)
summary(tibia_Condition_f)
car::Anova(tibia_Condition_f)
tibia_means_f <- as.data.frame(emmeans(tibia_Condition_f, specs = c("cohort_factor", "treatment", "sex")))
tibia_condition_supp <- plot(pairs(emmeans(tibia_Condition_f, ~treatment|sex, var = "cohort_factor"))) +
geom_vline(xintercept = 0, alpha = 0.5, linetype=2) +
ylab("Tibia") +
xlab(NULL) +
xlim(c(-0.1,0.1)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
tibia_condition_plot <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tibia") +
theme(plot.title = element_text(hjust = 0.5)) +
ylab(NULL) +
xlab(NULL) +
theme(legend.position="none") +
theme_classic() +
geom_point(position = position_dodge(width = 0.4), show.legend = FALSE) +
scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
#tarsus
tarsus_Condition_f <- glmmTMB(tarsus ~ (sex + treatment + cohort_factor)^3
+ diag(1 + thorax_c + cohort_factor| treatment:replicate),
data = wide_fly)
summary(tarsus_Condition_f)
car::Anova(tarsus_Condition_f)
tarsus_means_f <- as.data.frame(emmeans(tarsus_Condition_f, specs = c("cohort_factor", "treatment", "sex")))
tarsus_condition_supp <- plot(pairs(emmeans(tarsus_Condition_f, ~treatment|sex, var = "cohort_factor"))) +
geom_vline(xintercept = 0, alpha = 0.5, linetype=2) +
ylab("Tarsus") +
xlab(NULL) +
xlim(c(-0.1,0.1))
tarsus_condition_plot <- ggplot(tarsus_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tarsus") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
xlab(NULL) +
ylab(NULL) +
geom_point(position = position_dodge(width = 0.4),show.legend = FALSE) +
scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
dummy_plot <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tarsus") +
theme(plot.title = element_text(hjust = 0.5)) +
ylab(NULL) +
xlab(NULL) +
theme_classic() +
guides(fill="none",shape="none") +
guides(color = guide_legend(override.aes = list(size = 3))) +
theme(legend.title = element_text(size = 9),
legend.text = element_text(size = 9)) +
geom_point(size = 9, position = position_dodge(width = 0.4)) +
scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
dummy_plot_2 <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 4), show.legend = FALSE) +
ggtitle("Tarsus") +
theme(plot.title = element_text(hjust = 5)) +
ylab(NULL) +
xlab(NULL) +
theme_classic() +
guides(fill="none",colour="none") +
#guides(color = guide_legend(override.aes = list(size = 0.75))) +
theme(legend.title = element_text(size = 9),
legend.text = element_text(size = 9)) +
geom_point(size = 5, position = position_dodge(width = 7)) +
scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
treatment_legend <- get_legend(dummy_plot)
shape_legend <- get_legend(dummy_plot_2)
legend <- plot_grid(treatment_legend,shape_legend,ncol = 2, align = 'hv', axis = 'a', rel_widths = c(1, 1.5))
response_condition <- plot_grid(femur_condition_plot,tibia_condition_plot,tarsus_condition_plot,head_condition_plot,wing_condition_plot,legend,axis = "t")
## plotting supplemental contrast
plot_grid(wing_condition_supp,head_condition_supp,femur_condition_supp,tibia_condition_supp,tarsus_condition_supp,ncol = 1)
# Head
emmeans_for_SSD_contrast_head <- emmeans(head_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_head_bytreat <- contrast(emmeans_for_SSD_contrast_head[[1]],
interaction = c(treatment = "trt.vs.ctrl1"),
by = "cohort_factor")
as.data.frame(as.data.frame(SSD_contrasts_head_bytreat))
SSD_contrasts_head <- contrast(emmeans_for_SSD_contrast_head[[1]],
interaction = c(treatment = "trt.vs.ctrl1", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
head_SSD <- as.data.frame(SSD_contrasts_head)
base_head <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_head$contrasts)))
head_contrast_plot <- ggplot(confint(SSD_contrasts_head), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.75), size = 0.25) +
ylab("Head") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.17,0.17)) +
theme(axis.ticks = element_blank(), axis.text.x = element_blank(), legend.position = "none")
# This plot is even less intuitive
# Plotting a different way but not for the stats
head_SSD_plot <- ggplot(base_head, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Head") +
xlab("Days Starved") +
scale_colour_grey(start = 0,end = 0.75,aesthetics = "colour") +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE)
# Wing
emmeans_for_SSD_contrast_wing <- emmeans(wing_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_wing_bytreat <- contrast(emmeans_for_SSD_contrast_wing[[1]],
interaction = c(treatment = "trt.vs.ctrl1"),
by = "cohort_factor")
SSD_contrasts_wing <- contrast(emmeans_for_SSD_contrast_wing[[1]],
interaction = c(treatment = "trt.vs.ctrl1", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
wing_SSD <- as.data.frame(SSD_contrasts_wing)
base_wing <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_wing$contrasts)))
wing_contrast_plot <- ggplot(confint(SSD_contrasts_wing), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.75), size = 0.25) +
ylab("Wing") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.17,0.17)) +
theme(axis.ticks = element_blank(), axis.text.x = element_blank(), legend.position = "none")
# This plot is even less intuitive
# Plotting a different way but not for the stats
wing_SSD_plot <- ggplot(base_wing, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Wing") +
xlab("Days Starved") +
scale_colour_grey(start = 0,end = 0.75,aesthetics = "colour") +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE)
# Femur
emmeans_for_SSD_contrast_femur <- emmeans(femur_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_femur_bytreat <- contrast(emmeans_for_SSD_contrast_femur[[1]],
interaction = c(treatment = "trt.vs.ctrl1"),
by = "cohort_factor")
SSD_contrasts_femur <- contrast(emmeans_for_SSD_contrast_femur[[1]],
interaction = c(treatment = "trt.vs.ctrl1", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
femur_SSD <- as.data.frame(SSD_contrasts_femur)
base_femur <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_femur$contrasts)))
femur_contrast_plot <- ggplot(confint(SSD_contrasts_femur), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.75), size = 0.25) +
ylab("Femur") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.17,0.17)) +
theme(axis.ticks = element_blank(), axis.text.x = element_blank(), legend.position = "none")
# This plot is even less intuitive
# Plotting a different way but not for the stats
femur_SSD_plot <- ggplot(base_femur, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Femur") +
scale_colour_grey(start = 0,end = 0.85,aesthetics = "colour") +
ylim(-0.15,0.125) +
xlab(NULL) +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE)
# Tibia
emmeans_for_SSD_contrast_tibia <- emmeans(tibia_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_tibia_bytreat <- contrast(emmeans_for_SSD_contrast_tibia[[1]],
interaction = c(treatment = "trt.vs.ctrl1"),
by = "cohort_factor")
SSD_contrasts_tibia <- contrast(emmeans_for_SSD_contrast_tibia[[1]],
interaction = c(treatment = "trt.vs.ctrl1", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
tibia_SSD <- as.data.frame(SSD_contrasts_tibia)
base_tibia <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tibia$contrasts)))
tibia_contrast_plot <- ggplot(confint(SSD_contrasts_tibia), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.75), size = 0.25) +
ylab("Tibia") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.17,0.17)) +
theme(axis.ticks = element_blank(), axis.text.x = element_blank(), legend.position = "none")
# This plot is even less intuitive
# Plotting a different way but not for the stats
tibia_SSD_plot <- ggplot(base_tibia, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Tibia") +
scale_colour_grey(start = 0,end = 0.85,aesthetics = "colour") +
ylim(-0.15,0.125) +
xlab(NULL) +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE) +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())
# Tarsus
emmeans_for_SSD_contrast_tarsus <- emmeans(tarsus_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_tarsus_bytreat <- contrast(emmeans_for_SSD_contrast_tarsus[[1]],
interaction = c(treatment = "trt.vs.ctrl1"),
by = "cohort_factor")
SSD_contrasts_tarsus <- contrast(emmeans_for_SSD_contrast_tarsus[[1]],
interaction = c(treatment = "trt.vs.ctrl1", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
tarsus_SSD <- as.data.frame(SSD_contrasts_tarsus)
base_tarsus <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tarsus$contrasts)))
tarsus_contrast_plot <- ggplot(confint(SSD_contrasts_tarsus), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tarsus") +
xlab("F-M contrast between treatment") +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.17,0.17)) +
theme(axis.ticks = element_blank(),legend.position = "none")
# This plot is even less intuitive
# Plotting a different way but not for the stats
tarsus_SSD_plot <- ggplot(base_tarsus, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Tarsus") +
scale_colour_grey(start = 0,end = 0.85,aesthetics = "colour") +
ylim(-0.15,0.125) +
xlab(NULL) +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE) +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())
library(grid)
y.grob <- textGrob("Sexual Dimorphism (F - M)", rot = 90)
x.grob <- textGrob("Condition Cohort")
part_1 <- plot_grid(femur_SSD_plot,tibia_SSD_plot,tarsus_SSD_plot,ncol = 3)
part_2 <- plot_grid(y.grob,part_1,rel_widths = c(0.05,1))
part_3 <- plot_grid(part_2,x.grob,ncol = 1,rel_heights = c(1,0.1))
## Contrast plot for SSD
plot1 <- plot_grid(wing_contrast_plot,head_contrast_plot,femur_contrast_plot,tibia_contrast_plot,tarsus_contrast_plot,ncol = 1,rel_heights = c(0.65,0.65,0.65,0.65,1))
dummy_plot <- ggplot(confint(SSD_contrasts_tarsus), aes(x=estimate, y=treatment_trt.vs.ctrl1, colour=cohort_factor_trt.vs.ctrl1)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tarsus") +
xlab("F-M contrast between treatment") +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = "Days starved contrast") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.075,0.075)) +
theme(axis.ticks = element_blank()) +
guides(colour=guide_legend("Days\nstarved\ncontrast"))
legend <- get_legend(dummy_plot)
F75_SSD_condition <- plot_grid(plot1,legend,rel_widths = c(1,0.2))
SSD_wing <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_wing$contrasts)))
SSD_head <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_head$contrasts)))
SSD_femur <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_femur$contrasts)))
SSD_tibia <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tibia$contrasts)))
SSD_tarsus <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tarsus$contrasts)))
wing_SSD_plot <- ggplot(SSD_wing[SSD_wing$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Wing") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
head_SSD_plot <- ggplot(SSD_head[SSD_head$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Head") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
femur_SSD_plot <- ggplot(SSD_femur[SSD_femur$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Femur") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
tibia_SSD_plot <- ggplot(SSD_tibia[SSD_tibia$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tibia") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
tarsus_SSD_plot <- ggplot(SSD_tarsus[SSD_tarsus$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tarsus") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
F75_SSD <- plot_grid(femur_SSD_plot,tibia_SSD_plot,tarsus_SSD_plot,wing_SSD_plot,head_SSD_plot,ncol = 1,rel_heights = c(1,1,1,1,1))
SSD_wing <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_wing$contrasts)))
SSD_head <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_head$contrasts)))
SSD_femur <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_femur$contrasts)))
SSD_tibia <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tibia$contrasts)))
SSD_tarsus <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tarsus$contrasts)))
wing_SSD_plot <- ggplot(SSD_wing[SSD_wing$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Wing") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
head_SSD_plot <- ggplot(SSD_head[SSD_head$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Head") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
femur_SSD_plot <- ggplot(SSD_femur[SSD_femur$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Femur") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
tibia_SSD_plot <- ggplot(SSD_tibia[SSD_tibia$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tibia") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
tarsus_SSD_plot <- ggplot(SSD_tarsus[SSD_tarsus$cohort_factor == 0,], aes(x=estimate, y=treatment, colour=cohort_factor)) +
geom_pointrange(aes(xmin = upper.CL, xmax = lower.CL), position = position_dodge(width=0.85), size = 0.25) +
ylab("Tarsus") +
xlab(NULL) +
geom_vline(xintercept = 0, lty = 2 , alpha = 0.5) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
scale_colour_grey(start = 0.5, end = 0) +
xlim(c(-0.15,0.15)) +
theme(axis.ticks = element_blank(),legend.position = "none")
F75_SSD <- plot_grid(femur_SSD_plot,tibia_SSD_plot,tarsus_SSD_plot,wing_SSD_plot,head_SSD_plot,ncol = 1,rel_heights = c(1,1,1,1,1))
#wing model
# Making cohort numeric so that I can model trends of condition
wide_fly$cohort_numeric <- as.numeric(wide_fly$cohort)
wing_Condition_mod1 <- glmmTMB(wing ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric| treatment:replicate),
data = wide_fly)
summary(wing_Condition_mod1)
# Interaction between sex, condition, and treatments
wing_anova <- as.data.frame(car::Anova(wing_Condition_mod1))
#Interaction between sex, condition, and treatments
wing_slopes_mod1 <- emtrends(wing_Condition_mod1, ~ treatment|sex, var = "cohort_numeric")
pairs(wing_slopes_mod1)
plot(wing_slopes_mod1)
# Female wings becoming less condition dependent in treatments
# Males not responding
wing_slope <- cbind(as.data.frame(wing_slopes_mod1), trait=c("wing"))
# interaction contrast for slopes - added by ID 12/03/2025 in response to reviewer comment
wing_slopes_interactionContrast_setup <- emtrends(wing_Condition_mod1, pairwise ~ treatment|sex, var = "cohort_numeric")
wing_slopes_interaction_contrast <- contrast(wing_slopes_interactionContrast_setup[[1]],
interaction = c(Treatment = "trt.vs.ctrl1", sex = "pairwise"),
by = NULL)
wing_slopes_interaction_contrast
# head
head_Condition <- glmmTMB(head~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric| treatment:replicate),
data = wide_fly)
summary(head_Condition)
# Minor interaction between condition sex and UCT
head_anova <- as.data.frame(car::Anova(head_Condition))
# Interaction between condition, sex, and treatment
head_slopes_mod1 <- emtrends(head_Condition, ~ treatment|sex, var = "cohort_numeric")
plot(head_slopes_mod1)
pairs(head_slopes_mod1)
# Female heads becoming less condition dependent in UCT
# Males unchanged, moving in direction of becoming less condition dependent
head_slope <- cbind(as.data.frame(head_slopes_mod1), trait=c("head"))
# femur
femur_Condition <- glmmTMB(femur ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric| treatment:replicate),
data = wide_fly)
summary(femur_Condition)
# No interaction sex:cohort:treatment
car::Anova(femur_Condition)
# Minor interaction sex:cohort:treatment
femur_slopes_mod1 <- emtrends(femur_Condition, ~ treatment|sex, var = "cohort_numeric")
plot(femur_slopes_mod1)
pairs(femur_slopes_mod1)
# Female femur unchanged, moving in different dorection in the two treatments
# Males unchanged
femur_slope <- cbind(as.data.frame(femur_slopes_mod1), trait=c("femur"))
#Tibia model
tibia_Condition <- glmmTMB(tibia ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric| treatment:replicate),
data = wide_fly)
summary(tibia_Condition)
#sexM:treatmentSCTR:cohort *
car::Anova(tibia_Condition)
# No sex:treatment:condition interaction
tibia_slopes_mod1 <- emtrends(tibia_Condition, ~ treatment|sex, var = "cohort_numeric")
plot(tibia_slopes_mod1)
pairs(tibia_slopes_mod1)
# Females in SCT are more condition dependent for tibia
# Males unchanged
tibia_slope <- cbind(as.data.frame(tibia_slopes_mod1), trait=c("tibia"))
#tarsus
tarsus_Condition <- glmmTMB(tarsus ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric| treatment:replicate),
data = wide_fly)
summary(tarsus_Condition)
# No sex:treatment:condition interaction
car::Anova(tarsus_Condition)
# no sex:treatment:condition interaction
tarsus_slopes_mod1 <- emtrends(tarsus_Condition, ~ treatment|sex, var = "cohort_numeric")
plot(tarsus_slopes_mod1)
pairs(tarsus_slopes_mod1)
# added in response to reviewer comments about interactions
tarsus_slopes_interactionContrast_setup <- emtrends(tarsus_Condition, pairwise ~ treatment|sex, var = "cohort_numeric")
tarsus_slopes_interaction_contrast <- contrast(tarsus_slopes_interactionContrast_setup[[1]],
interaction = c(Treatment = "trt.vs.ctrl1", sex = "pairwise"),
by = NULL)
# Females in UCT are less condition dependent, SCT moving in the direction of less condition dependent
# Males less condition dependent
tarsus_slope <- cbind(as.data.frame(tarsus_slopes_mod1), trait=c("tarsus"))
#
con_trends <- as.data.frame(rbind(wing_slope,head_slope,femur_slope,tibia_slope,tarsus_slope))
con_trends$trait <- as.factor(con_trends$trait)
con_trends$trait <- factor(con_trends$trait, levels = c("wing", "head", "femur", "tibia", "tarsus"))
con_trends$treatment <- factor(con_trends$treatment, levels = c("SCT", "UCT", "NT"))
con_trends$cohort <- factor(con_trends$cohort,levels = c("2", "1", "0"))
# figure
trend_condition <- ggplot(con_trends, aes(x=cohort_numeric.trend, y = treatment, shape = sex, colour = treatment)) +
geom_linerange(aes(xmin=lower.CL,xmax=upper.CL),position=position_dodge2(width = 0.9), show.legend = FALSE) +
theme(strip.text.x = element_blank()) +
theme_classic() +
facet_wrap(~trait, ncol = 1, strip.position = "right") +
ylab(NULL) +
xlab("Slope of condition") +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.line.y = element_blank(), legend.position = "none") +
geom_point(position = position_dodge2(width = 0.90), show.legend = FALSE) +
scale_colour_grey(start = 0,end = 0.75,aesthetics = "colour")
first_plot <- plot_grid(response_condition,trend_condition,rel_widths = c(1,0.5))
F75_condition <- plot_grid(first_plot,rel_widths = c(1,0.1))
thorax_Condition_f <- glmmTMB(thorax_c ~ (sex + treatment + cohort_factor)^3
+ diag(1 + cohort_factor | treatment:replicate),
data = wide_fly)
summary(thorax_Condition_f)
car::Anova(tarsus_Condition_f)
thorax_means_f <- as.data.frame(emmeans(thorax_Condition_f, specs = c("cohort_factor", "treatment", "sex")))
thorax_condition_supp <- plot(pairs(emmeans(thorax_Condition_f, ~treatment|sex, var = "cohort_factor"))) +
geom_vline(xintercept = 0, alpha = 0.5, linetype=2) +
ylab("Thorax") +
xlab("Condition response contrast") +
xlim(c(-0.1,0.1))
thorax_condition_plot <- ggplot(thorax_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Thorax F75") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position="none") +
theme_classic() +
ylab("Thorax size (mm)") +
geom_point(position = position_dodge(width = 0.4)) +
scale_colour_grey(start = 0.75,end = 0,aesthetics = "colour")
