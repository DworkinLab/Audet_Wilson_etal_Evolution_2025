SSD_contrasts_femur <- contrast(emmeans_for_SSD_contrast_femur[[1]],
interaction = c(treatment = "pairwise", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
femur_SSD <- as.data.frame(SSD_contrasts_femur)
base_femur <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_femur$contrasts)))
# Plotting a different way but not for the stats
femur_SSD_plot <- ggplot(base_femur, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Tarsus") +
xlab(NULL) +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE)
#Tibia model
tibia_Condition_f <- glmmTMB(tibia ~ (sex + treatment + cohort_factor)^3
+ diag(1 + thorax_c + cohort_factor | treatment:replicate),
data = wide_fly)
summary(tibia_Condition_f)
car::Anova(tibia_Condition_f)
tibia_means_f <- as.data.frame(emmeans(tibia_Condition_f, specs = c("cohort_factor", "treatment", "sex")))
tibia_condition_plot <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tibia") +
theme(plot.title = element_text(hjust = 0.5)) +
ylab(NULL) +
xlab(NULL) +
theme(legend.position="none") +
theme_classic() +
geom_point(position = position_dodge(width = 0.4), show.legend = FALSE)
emmeans_for_SSD_contrast_tibia <- emmeans(tibia_Condition_f, pairwise ~sex | treatment + cohort_factor)
SSD_contrasts_tibia <- contrast(emmeans_for_SSD_contrast_tibia[[1]],
interaction = c(treatment = "pairwise", cohort_factor = "trt.vs.ctrl1"),
by = NULL)
tibia_SSD <- as.data.frame(SSD_contrasts_tibia)
base_tibia <- as.data.frame(as.data.frame(confint(emmeans_for_SSD_contrast_tibia$contrasts)))
# Plotting a different way but not for the stats
tibia_SSD_plot <- ggplot(base_tibia, aes(x = cohort_factor, y = estimate,colour = treatment, group = treatment)) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), show.legend = FALSE, position = position_dodge(width = 0.4), width = .1) +
theme(legend.position="none") +
ggtitle("Tarsus") +
xlab(NULL) +
ylab(NULL) +
theme_classic() +
geom_line(position = position_dodge(width = 0.4), show.legend = FALSE)
dummy_plot <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tarsus") +
theme(plot.title = element_text(hjust = 0.5)) +
ylab(NULL) +
xlab(NULL) +
theme_classic() +
guides(fill="none",shape="none") +
guides(color = guide_legend(override.aes = list(size = 0.75))) +
theme(legend.title = element_text(size = 5),
legend.text = element_text(size = 5)) +
geom_point(position = position_dodge(width = 0.4))
dummy_plot_2 <- ggplot(tibia_means_f, aes(x = cohort_factor, y = 2^(emmean), colour = treatment, shape = sex)) +
geom_linerange(aes(ymin = 2^(lower.CL), ymax = 2^(upper.CL)), position = position_dodge(width = 0.4), show.legend = FALSE) +
ggtitle("Tarsus") +
theme(plot.title = element_text(hjust = 0.5)) +
ylab(NULL) +
xlab(NULL) +
theme_classic() +
guides(fill="none",colour="none") +
#guides(color = guide_legend(override.aes = list(size = 0.75))) +
theme(legend.title = element_text(size = 5),
legend.text = element_text(size = 5)) +
geom_point(position = position_dodge(width = 0.4))
treatment_legend <- get_legend(dummy_plot)
shape_legend <- get_legend(dummy_plot_2)
legend <- plot_grid(treatment_legend,shape_legend,ncol = 1, align = 'hv', axis = 'b', rel_widths = c(1, 1.5))
response_condition <- plot_grid(femur_condition_plot,tibia_condition_plot,head_condition_plot,wing_condition_plot,axis = "t")
response_condition
# Making cohort numeric so that I can model trends of condition
wide_fly$cohort_numeric <- as.numeric(wide_fly$cohort)
wing_Condition_mod1 <- glmmTMB(winglength ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric | treatment:replicate),
data = wide_fly)
summary(wing_Condition_mod1)
# Interaction between sex, condition, and UCT
car::Anova(wing_Condition_mod1)
wing_slopes_mod1 <- emtrends(wing_Condition_mod1, ~ treatment|sex, var = "cohort_numeric")
plot(wing_slopes_mod1)
wing_slope <- cbind(as.data.frame(wing_slopes_mod1), trait=c("wing"))
# head
head_Condition_n <- glmmTMB(head ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric | treatment:replicate),
data = wide_fly)
summary(head_Condition_n)
# Minor interaction between condition sex and SCT
car::Anova(head_Condition_n)
head_slopes_mod1 <- emtrends(head_Condition_n, ~ treatment|sex, var = "cohort_numeric")
plot(head_slopes_mod1)
head_slope <- cbind(as.data.frame(head_slopes_mod1), trait=c("head"))
# femur
femur_Condition_n <- glmmTMB(femur ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric | treatment:replicate),
data = wide_fly)
summary(femur_Condition_n)
# No interaction sex:cohort:treatment
car::Anova(femur_Condition_n)
femur_slopes_mod1 <- emtrends(femur_Condition_n, ~ treatment|sex, var = "cohort_numeric")
plot(femur_slopes_mod1)
femur_slope <- cbind(as.data.frame(femur_slopes_mod1), trait=c("femur"))
#Tibia model
tibia_Condition_n <- glmmTMB(tibia ~ (sex + treatment + cohort_numeric)^3
+ diag(1 + thorax_c + cohort_numeric | treatment:replicate),
data = wide_fly)
summary(tibia_Condition_n)
car::Anova(tibia_Condition_n)
tibia_slopes_mod1 <- emtrends(tibia_Condition_n, ~ treatment|sex, var = "cohort_numeric")
plot(tibia_slopes_mod1)
tibia_slope <- cbind(as.data.frame(tibia_slopes_mod1), trait=c("tibia"))
con_trends <- as.data.frame(rbind(wing_slope,head_slope,femur_slope,tibia_slope))
con_trends$trait <- as.factor(con_trends$trait)
levels(con_trends$trait) <- c("wing", "head", "femur", "tibia", "tarsus")
levels(con_trends$treatment) <- c("SCT", "UCT", "NTR")
levels(con_trends$cohort) <- c("2", "1", "0")
# figure
trend_condition <- ggplot(con_trends, aes(x=cohort_numeric.trend, y = treatment, shape = sex, colour = treatment)) +
geom_linerange(aes(xmin=lower.CL,xmax=upper.CL),position=position_dodge2(width = 0.9), show.legend = FALSE) +
theme(strip.text.x = element_blank()) +
theme_classic() +
facet_wrap(~trait, ncol = 1, strip.position = "right") +
ylab(NULL) +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.line.y = element_blank()) +
geom_point(position = position_dodge2(width = 0.90), show.legend = FALSE)
first_plot <- plot_grid(response_condition,trend_condition,rel_widths = c(1,0.4))
plot_grid(first_plot, legend, rel_widths = c(1,0.1))
part_1 <- plot_grid(femur_SSD_plot,tibia_SSD_plot,tarsus_SSD_plot,wing_SSD_plot,head_SSD_plot,legend,ncol = 2)
part_1 <- plot_grid(femur_SSD_plot,tibia_SSD_plot,wing_SSD_plot,head_SSD_plot,legend,ncol = 2)
part_1
part_1 <- plot_grid(femur_SSD_plot,tibia_SSD_plot,wing_SSD_plot,head_SSD_plot,ncol = 2)
plot_grid(part_1,legend)
plot_grid(part_1,legend,rel_widths = c(1,0.1))
rawdat_simple
rm(list=ls())
library(cowplot)
library(effects)
library(tidyr)
#library(skimr)
library(ggplot2)
library(ggbeeswarm)
library(ggridges)
library(glmmTMB)
library(emmeans)
library(effects)
library(dotwhisker)
library(car)
library(olsrr)
library(boot)
library(DHARMa)
library(dplyr)
library(plyr)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Terry_flies/data/")
rawdat <- read.csv("TA_Measurements_F75_working.csv")
# Turn my unmeasureables into NAs
index_50 <- which(rawdat$Length_px < 50)
rawdat$Length_px[index_50] <- NA
#Find and remove duplicate measures
length(rawdat$Label)
length(unique(rawdat$Label))
which(duplicated(rawdat$Label))
rawdat <- rawdat[-c(which(duplicated(rawdat$Label))),]
length(rawdat$Label)
length(unique(rawdat$Label))
# Convert to um from pixel
rawdat$length_um <- rawdat$Length_px * 1.8599975
rawdat$log_size <- log2(rawdat$length_um)
rawdat_seperate <- separate(rawdat,
col = Label,
into = c("Imager","Replicate","Cohort","Sex","Trait", "Individual"), sep = "_")
rawdat_seperate$Individual <- gsub(x = rawdat_seperate$Individual,
pattern = ".tif",
replacement = "")
rawdat_seperate$Cohort <- gsub(x = rawdat_seperate$Cohort,
pattern = "C",
replacement = "")
rawdat_seperate$Cohort <- gsub(x = rawdat_seperate$Cohort,
pattern = "C",
replacement = "")
## Using Table to see the sample sizes and if they are what you expect by groups
with(rawdat_seperate[rawdat_seperate$Trait == "HEAD",],
table(interaction(Replicate, Sex, drop = T), Cohort))
rawdat_seperate$fly_id <- paste(rawdat_seperate$Replicate,
rawdat_seperate$Cohort,
rawdat_seperate$Sex,
rawdat_seperate$Individual,
sep = "_")
names(rawdat_seperate)
rawdat_simple <- rawdat_seperate[, c(3,4,5,6,10,11)]
rawdat_simple$fly_id <- gsub("UCTR2_0_F_10", "UCTR2_0_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("UCTR4_2_F_15", "UCTR4_2_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR1_1_M_19", "NTR1_1_F_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR1_2_F_10", "NTR1_2_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR1_2_F_12", "NTR1_2_M_22", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR1_2_F_7", "NTR1_2_M_23", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR2_2_F_19", "NTR2_2_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR3_0_F_15", "NTR3_0_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR3_0_F_16", "NTR3_0_M_22", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR3_0_F_3", "NTR3_0_M_23", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("NTR4_0_F_20", "NTR4_0_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("SCTR2_0_F_3", "SCTR2_0_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("SCTR1_0_M_6", "SCTR1_0_F_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("SCTR2_1_M_4", "SCTR2_1_F_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("SCTR2_2_F_4", "SCTR2_2_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("SCTR3_1_M_14", "SCTR3_1_F_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("UCTR1_0_F_20", "UCTR1_0_M_21", rawdat_simple$fly_id)
rawdat_simple$fly_id <- gsub("UCTR1_2_F_7", "UCTR1_2_M_21", rawdat_simple$fly_id)
rawdat_simple <- rawdat_simple[,-c(1:3)]
rawdat_simple <- separate(rawdat_simple,
col = fly_id,
into = c("Replicate","Cohort","Sex","Individual"), sep = "_")
rawdat_seperate$fly_id <- paste(rawdat_seperate$Replicate,
rawdat_seperate$Cohort,
rawdat_seperate$Sex,
rawdat_seperate$Individual,
sep = "_")
with(rawdat_simple[rawdat_simple$Trait == "HEAD",],
table(interaction(Replicate, Sex, drop = T), Cohort))
wide_fly <- as.data.frame(pivot_wider(rawdat_simple,
names_from = "Trait",
values_from = "log_size"))
head(wide_fly)
wide_fly <- wide_fly %>%
separate(Replicate,
into = c("Treatment", "Replicate"),
sep = "(?<=[A-Za-z])(?=[0-9])"
)
colnames(wide_fly) <- tolower(colnames(wide_fly))
wide_fly$cohort <- as.numeric(wide_fly$cohort)
missing_by_row <- apply(wide_fly, MARGIN = 1, anyNA)
dim(wide_fly)
length(missing_by_row )
temp_dat <- wide_fly[missing_by_row ,]
# for a matrix or array, apply can be super useful
apply(wide_fly[, 6:11], MARGIN = 2, quantile, na.rm = TRUE)
# or sapply will do the same since this is a data.frame we are using
sapply(wide_fly[, 6:11], quantile, na.rm = TRUE)
with(wide_fly,
tapply(head,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
with(wide_fly,
tapply(thorax,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
with(wide_fly,
tapply(wing,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
with(wide_fly,
tapply(femur,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
with(wide_fly,
tapply(tibia,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
with(wide_fly,
tapply(tarsus,
INDEX = list(interaction(treatment, replicate, drop = T), cohort, sex),
max, na.rm = TRUE))
#skim(wide_fly)
```
## Plots of the raw data
#Trait by sex histogram
ggplot(wide_fly, aes(x = femur, fill = treatment)) +
facet_wrap(vars(sex)) +
geom_histogram(binwidth = 0.05, alpha = 0.8)
# ID: I added this in
ggplot(wide_fly, aes(x = femur, colour = treatment)) +
geom_density(alpha = 0.7) +
facet_wrap(vars(sex))
# NOTE FROM ID: but you may find ridge plots easier to see
ggplot(wide_fly, aes(x = femur, y = treatment, colour = treatment)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(sex))
ggplot(wide_fly, aes(x = cohort, y = head, colour = treatment)) +
geom_quasirandom(alpha = 0.4) +
geom_smooth() +
facet_wrap(vars(sex))
ggplot(wide_fly, aes(x = replicate, y = head, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
ggplot(wide_fly, aes(x = replicate, y = thorax, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
ggplot(wide_fly, aes(x = replicate, y = wing, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
ggplot(wide_fly, aes(x = replicate, y = femur, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
ggplot(wide_fly, aes(x = replicate, y = tibia, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
ggplot(wide_fly, aes(x = replicate, y = tarsus, colour = as.factor(cohort))) +
geom_quasirandom(alpha = 0.4) +
facet_wrap(vars(treatment, sex))
?pivot_longer
names(wide_fly)
narrow_fly <- as.data.frame(pivot_longer(wide_fly, cols = c("femur", "head", "tarsus", "thorax", "tibia", "wing"),
names_to = "trait"))
narrow_fly
narrow_fly <- as.data.frame(pivot_longer(wide_fly, cols = c("femur", "head", "tarsus", "thorax", "tibia", "wing"),
names_to = "trait", values_to = "log_size"))
narrow_fly
ggplot(narrow_fly, aes(x = log_size, y = cohort, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = cohort_0, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
names(narrow_fly)
ggplot(narrow_fly, aes(x = log_size, y = cohort, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = cohort, colour = sex)) +
geom_density_ridges(alpha = 0.5, y = cohort) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = cohort, colour = sex)) +
geom_density_ridges(alpha = 0.5, y = "cohort") +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex, shape = cohort)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex, line = cohort)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex, linetype = cohort)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex, linetype = cohort)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(trait~cohort))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex, linetype = cohort)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(cohort))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_wrap(vars(cohort))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(cohort~trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(trait))
?facet_grid
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(rows = cohort, cols = trait)
names(narrow_fly)
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(rows = "cohort", cols = "trait")
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(rows = "cohort", cols = "trait"))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(rows = cohort, cols = trait))
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(rows = trait, cols = cohort))
?facet_grid
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(rows = trait, cols = cohort), scales = "free")
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(trait))
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(trait))
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(trait), scale = "free")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
theme_classic() +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
theme_grid() +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
theme_bw() +
facet_wrap(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_density_ridges(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = log_size, y = treatment, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scale = "free_y")
ggplot(narrow_fly, aes(x = log_size, y = treatment, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait, cohort), scale = "free_y")
ggplot(narrow_fly, aes(x = treatment, y = log_size, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait, cohort), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = log_size, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait, cohort), scale = "free_y")
filter(narrow_fly, cohort == "1") %>%
ggplot(aes(x = treatment, y = log_size, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait, cohort), scale = "free_y")
filter(narrow_fly, cohort == "2") %>%
ggplot(aes(x = treatment, y = log_size, colour = sex)) +
geom_quasirandom(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scale = "free_y")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = log_size, colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait))
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = log_size, colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scales = "free_x")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scales = "free_x")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(vars(trait), scales="free_x")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(~trait, scales="free_x")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(~trait, scales="free")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(.~trait, scales="free")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = treatment, y = 2^(log_size), colour = sex)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
filter(narrow_fly, cohort == "0") %>%
ggplot(aes(x = sex, y = 2^(log_size), colour = treatment)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
filter(narrow_fly, cohort == "2") %>%
ggplot(aes(x = sex, y = 2^(log_size), colour = treatment)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
levels(narrow_fly$treatment) <- c("SCT", "UCT", "NTR")
filter(narrow_fly, cohort == "2") %>%
ggplot(aes(x = sex, y = 2^(log_size), colour = treatment)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
narrow_fly
filter(narrow_fly, cohort == "2") %>%
ggplot(aes(x = sex, y = 2^(log_size), colour = treatment)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
ggplot(narrow_fly, aes(x = sex, y = 2^(log_size), colour = treatment)) +
geom_boxplot(alpha = 0.5) +
theme_bw() +
facet_grid(trait~., scales="free")
